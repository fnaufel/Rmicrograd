
go <-  function(v) {
  v$clear_grads()
  v$grad <- 1
  v$backward()
  v
}

# Tests -------------------------------------------------------------------

v1 <- Value$new(10)
v2 <- Value$new(20)
v3 <- Value$new(30)

# Expressions --------------------------------------------------------------

e <- v1 + v2 * v3
e

e <- (v1 + v1) * (v2 + v3)
e

# Circular?
e <- v1 + v1 * v1
e

# Addition ----------------------------------------------------------------

go(v1 + v2)
go(v1 + v1)

# Multiplication ----------------------------------------------------------

go(v1 * v2)
go(v1 * v1)

# Pow ---------------------------------------------------------------------

go(v1^2)
go(v1^0)
go(v1^1)
go(v1^-1)
go(v1^.5)

# ReLU --------------------------------------------------------------------
go(relu(Value$new(-1)))
go(relu(Value$new(0)))

# Negation ----------------------------------------------------------------
go(-v1)

# Subtraction -------------------------------------------------------------
go(v1 - v2)

# Division ----------------------------------------------------------------
go(v2/v1)

